<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>ReactJS - Comment Box!</title>
    </head>
    <body>

    </body>
    <script src="http://fb.me/react-0.8.0.js"></script>
    <script src="http://fb.me/JSXTransformer-0.8.0.js"></script>
    <script type="text/jsx">
     /** @jsx React.DOM */
     var InputField = React.createClass({
         handleSubmit: function() {
             var value = this.refs.field.getDOMNode().value.trim();

             if (value) {
                 this.props.onCommentSubmit(value);
                 this.refs.field.getDOMNode().value = '';
             }

             return false;
         },
         render: function() {
             return <form onSubmit={this.handleSubmit} action="javascript://">
                        <input ref="field" type="text" placeholder={this.props.title} />
                        {this.props.children}
                    </form>;
         }
     });

     var CommentsList = React.createClass({
         render: function() {
             var commentsNodes = this.props.comments.map(function(text, i){
                 // If it happens that our child has some state to hold and we
                 // want to maintain it or prevent passing it to other child
                 // during the reconciliation process, we should provide
                 // key={uid} attribute for each child at this level(sibling).
                 return <li key={text}>{text}</li>
             });

             return <section>
                        <ul> {commentsNodes} </ul>
                        {this.props.children}
                    </section>;
         }
     });

     var CommentsBox = React.createClass({
         getInitialState: function() {
             return { comments: ["Comment 1",
                                 "Comment 2",
                                 "Comment 3"] };
         },
         onCommentSubmit: function(comment) {
             var comments = this.state.comments;
             comments.unshift(comment);
             this.setState({comments: comments});
         },
         render: function() {
             return <section id="comments-box">
                        <head>
                            <h1> {'Hello ' + this.props.title} </h1>
                        </head>
                        <InputField title="Leave your comment ..." onCommentSubmit={this.onCommentSubmit}>
                            Input
                        </InputField>
                        <CommentsList comments={this.state.comments}>Comts</CommentsList>
                    </section>;
         }
     });
     React.renderComponent(<CommentsBox title="Simple comments box" />, document.body);
    </script>
</html>
